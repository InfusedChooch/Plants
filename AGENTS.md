# 🧠 agents.md — Portable Folder Guide & Build Instructions

This document replaces the older **AGENTS.md** and is written for the **stand‑alone / flash‑drive** distribution pictured in the screenshot.  It explains ***where every file lives, why it’s there, and how to recreate the folder from a fresh repo clone***.

---

## 1 📁 Final Portable Layout

```
RU Plant Guide\                     ← drop the whole folder onto a flash‑drive
│  Launcher.exe                     ← main GUI (PyInstaller **onedir**, exe moved up)
│
├─_internal\                        ← auto‑generated by PyInstaller; runtime DLLs
│
├─helpers\                          ← one‑file helper tools (no Python needed)
│      Excelify2.exe
│      FillMissingData.exe
│      GeneratePDF.exe
│      GetLinks.exe
│      PDFScraper.exe
│
├─Outputs\                          ← everything created by the tools
│   └─pdf_images\                   ← raw PNGs + converted JPEGs
│
├─Static\                           ← runtime assets only (no source .py)
│   ├─themes\rutgers.json           ← CTk dark‑mode theme for the GUI
│   ├─GoogleChromePortable\...      ← Portable Chrome (needed by Selenium)
│   └─chromedriver.exe              ← matching driver (optional if in Chrome‑bin)
│
└─Templates\                        ← hand‑edited or shipped reference files
    │  Plant Guide 2025 Update.pdf  ← source PDF the scraper reads
    │  Plants_Linked_Filled_Master.csv
    └─ (any future template CSV/PDFs)
```

> **Key rule:** *Everything* required to **run** must sit inside the same top‑level folder.<br>Copy the folder to *any* Windows machine (even one with no Python) and double‑click **Launcher.exe**.

---

## 2 🔎 Role of Each Component

| Path / File                          | Purpose                                                                                                                                                          |
| ------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Launcher.exe**                     | CustomTkinter GUI that chains the helper tools, shows logs, and lets users override paths & prefixes. Built in **onedir** so the Python runtime is bundled.      |
| `_internal\`                         | PyInstaller’s support DLLs / *.pyd* modules.  Leave it next to **Launcher.exe**.                                                                                 |
| **helpers\*.exe**                    | Single‑file builds of the original Python scripts.  Each one can be run manually or via the GUI.                                                                 |
| `Static\themes\rutgers.json`         | Color palette used by the GUI.                                                                                                                                   |
| `Static\GoogleChromePortable\`       | Self‑contained Chrome build used by Selenium (GetLinks.exe & FillMissingData.exe).                                                                               |
| `Static\chromedriver.exe` (optional) | Driver that exactly matches the portable Chrome **major** version.  If omitted, the helpers fall back to the driver shipped inside *Chrome‑bin\<ver>* subfolder. |
| **Templates\***                      | Reference input files – the untouched PDF guide and master CSV.  They are never overwritten.                                                                     |
| **Outputs\***                        | All CSV, Excel, image, and PDF exports land here.  The GUI auto‑creates it on first run.                                                                         |

---

## 3 🔨 Building the Folder From Source

> **Prerequisites:** Windows, Python 3.10 + (only for the build), `pip install -r requirements.txt`, and `pyinstaller`.

### Step‑by‑step

1. **Clone / pull** the repository somewhere on your dev PC.
2. **Install deps** (once):

   ```bash
   python -m pip install -r requirements.txt pyinstaller
   ```
3. **Build helper EXEs** into `helpers/` *(one‑file for speed & tidiness)*:

   ```bash
   pyinstaller Static/Python/PDFScraper.py      --onefile --noconfirm --windowed --distpath "helpers"
   pyinstaller Static/Python/GetLinks.py        --onefile --noconfirm --windowed --distpath "helpers"
   pyinstaller Static/Python/FillMissingData.py --onefile --noconfirm --windowed --distpath "helpers"
   pyinstaller Static/Python/GeneratePDF.py     --onefile --noconfirm --windowed --distpath "helpers"
   pyinstaller Static/Python/Excelify2.py       --onefile --noconfirm --windowed --distpath "helpers"
   ```
4. **Build the GUI** (keep it in *onedir* so its libs stay together):

   ```bash
   pyinstaller Launcher.py --onedir --noconfirm --windowed ^
     --add-data "Static;Static" ^
     --add-data "Templates;Templates" ^
     --add-data "helpers;helpers" ^
     --icon "Static/themes/leaf.ico"
   ```

   Move the generated **Launcher.exe** *up one level* next to `helpers/` and rename the build folder to `_internal/` (optional cosmetic step shown in the screenshot).
5. **Copy Portable Chrome** into `Static/GoogleChromePortable`.

   * Grab it from [https://portableapps.com/apps/internet/google\_chrome\_portable](https://portableapps.com/apps/internet/google_chrome_portable).
   * Make sure its **major version** matches the packed `chromedriver.exe`.
6. **Zip or drag** the `RU Plant Guide` folder onto a USB stick.  Done!

---

## 4 ▶️ Daily Use (Non‑developer)

1. Plug in the flash‑drive and open `RU Plant Guide\`.
2. Double‑click **Launcher.exe**.
3. ‑ Browse to the source `Plant Guide 2025 Update.pdf` if you haven’t already.
4. Click **Run** next to any step (*or run them in sequence*):

   1. **Extract from PDF** – makes `Outputs/Plants_NeedLinks.csv` and images.
   2. **Get Plant Links** – fills MBG/WF/nursery links.
   3. **Fill Missing Data** – scrapes heights, habitats, etc.
   4. **Generate PDF** – designs a printable guide with TOC & cards.
   5. **Export to Excel** – creates a formatted workbook.
5. Find results under `Outputs/` – ready to email or print.

*No local Python, pip, or admin rights required.*

---

## 5 💡 Tips & Gotchas

* **Path overrides** in the GUI are relative to the portable root, so moving the folder doesn’t break anything.
* If **Selenium can’t start Chrome**, verify that:

  * `Static/GoogleChromePortable/App/Chrome-bin/<ver>/chrome.exe` exists, and
  * `Static/chromedriver.exe` (or the driver inside `Chrome-bin`) shares the same **major** version number.
* The helper EXEs ignore any `%USERPROFILE%\.cache` locations and write temp files **next to themselves**, keeping the flash‑drive self‑contained.
* You can still run helpers directly from a command window if you need CLI power; each EXE prints its own `--help`.

---

## 6 🗂️ Source vs Portable Cheat‑sheet

| **Repository** (dev)                   | **Portable** (runtime)             |
| -------------------------------------- | ---------------------------------- |
| `Static/Python/*.py`                   | compiled into `helpers/*.exe`      |
| `Launcher.py` **+** PyInstaller output | `Launcher.exe` + `_internal/` libs |
| `Static/themes/`, `Templates/`         | copied verbatim                    |
| *venv*, tests, docs, etc.              | **omitted** to save space          |

---

Happy planting! 🌱
